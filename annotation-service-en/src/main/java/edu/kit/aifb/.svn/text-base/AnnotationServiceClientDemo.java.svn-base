package edu.kit.aifb;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;

import org.apache.commons.httpclient.HttpClient;
import org.apache.commons.httpclient.HttpException;
import org.apache.commons.httpclient.methods.InputStreamRequestEntity;
import org.apache.commons.httpclient.methods.PostMethod;

public class AnnotationServiceClientDemo {

	public static void main(String[] args) throws HttpException, IOException {
		// Target URL
		String strURL = "http://km.aifb.kit.edu/services/annotation-en/";
		
		// XML to be posted
		String strXML = "<item><sentences><sentence id=\"1\"><text>Unesco is now holding its biennial meetings in New York.</text><tokens><token pos=\"NP00SP0\" end=\"6\" lemma=\"unesco\" id=\"1.1\" start=\"0\">Unesco</token><token pos=\"VBZ\" end=\"9\" lemma=\"be\" id=\"1.2\" start=\"7\">is</token><token pos=\"RB\" end=\"13\" lemma=\"now\" id=\"1.3\" start=\"10\">now</token><token pos=\"VBG\" end=\"21\" lemma=\"hold\" id=\"1.4\" start=\"14\">holding</token><token pos=\"PRP$\" end=\"25\" lemma=\"its\" id=\"1.5\" start=\"22\">its</token><token pos=\"JJ\" end=\"34\" lemma=\"biennial\" id=\"1.6\" start=\"26\">biennial</token><token pos=\"NNS\" end=\"43\" lemma=\"meeting\" id=\"1.7\" start=\"35\">meetings</token><token pos=\"IN\" end=\"46\" lemma=\"in\" id=\"1.8\" start=\"44\">in</token><token pos=\"NP00G00\" end=\"55\" lemma=\"new_york\" id=\"1.9\" start=\"47\">New_York</token><token pos=\"Fp\" end=\"56\" lemma=\".\" id=\"1.10\" start=\"55\">.</token></tokens></sentence></sentences><entities><entity type=\"location\" displayName=\"new_york\" id=\"2\"><mentions><mention SentenceId=\"1\" id=\"1.9\" words=\"New York\"></mention></mentions></entity><entity type=\"person\" displayName=\"unesco\" id=\"1\"><mentions><mention SentenceId=\"1\" id=\"1.1\" words=\"Unesco\"></mention></mentions></entity></entities></item>";
		InputStream strXMLStream=new ByteArrayInputStream(strXML.getBytes());
		
		// Prepare HTTP post
		PostMethod post = new PostMethod(strURL);
		post.setRequestEntity(new InputStreamRequestEntity(strXMLStream, strXML.length()));
		post.setRequestHeader("Content-type", "text/xml; charset=UTF-8");

		// HTTP client
		HttpClient httpclient = new HttpClient();

		// // Execute request
		try {
			int result = httpclient.executeMethod(post);
			System.out.println("Response status code: " + result);

			System.out.println("Response body: ");
			System.out.println(post.getResponseBodyAsString());
		} finally {
			post.releaseConnection();
		}
	}
}
